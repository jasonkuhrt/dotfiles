#
# Kitty Config (primary terminal)
#
# Seamless hjkl navigation with nvim via smart-splits.nvim
# Reference: https://sw.kovidgoyal.net/kitty/conf/
#

#
# IPC (required for smart-splits.nvim)
#

allow_remote_control yes
listen_on unix:/tmp/mykitty

#
# Theme
#

# Applied on sync via: kitty +kitten themes --reload-in=all "Tokyo Night"
include current-theme.conf

#
# Typography
#

font_family      Monaspace Neon
font_size        14

#
# Cursor
#

cursor_blink_interval 0
cursor_opacity        0.3

#
# Window
#

hide_window_decorations no
macos_titlebar_color background
confirm_os_window_close 0

#
# Tab bar
#

tab_bar_edge            top
tab_bar_style           fade
tab_bar_min_tabs        1
tab_title_max_length    20
active_tab_font_style   bold
inactive_tab_font_style normal

#
# Layouts
#

# splits: required for vsplit/hsplit pane creation
# stack: used for pane zoom (toggle_layout stack)
enabled_layouts splits,stack

#
# macOS
#

macos_option_as_alt yes

#
# Clipboard
#

clipboard_control write-clipboard read-clipboard
paste_actions no-op

#
# Bell
#

enable_audio_bell no
visual_bell_duration 0.0
window_alert_on_bell yes

#
# Keybindings
#

# Clear screen
map ctrl+apostrophe clear_terminal scroll active

# Literal newline (for multi-line input)
map shift+enter send_text all \n

# ─────────────────────────────────────────────────────────
# Pane navigation (smart-splits.nvim integration)
#
# When nvim is focused (IS_NVIM user var set by smart-splits),
# keys pass through to nvim. Otherwise Kitty navigates directly.
# ─────────────────────────────────────────────────────────

map ctrl+j neighboring_window down
map ctrl+k neighboring_window up
map ctrl+h neighboring_window left
map ctrl+l neighboring_window right

# Unset when nvim is focused (pass through to smart-splits)
map --when-focus-on var:IS_NVIM ctrl+j
map --when-focus-on var:IS_NVIM ctrl+k
map --when-focus-on var:IS_NVIM ctrl+h
map --when-focus-on var:IS_NVIM ctrl+l

# ─────────────────────────────────────────────────────────
# Pane resizing (smart-splits.nvim kitten)
# ─────────────────────────────────────────────────────────

map alt+j kitten relative_resize.py down  3
map alt+k kitten relative_resize.py up    3
map alt+h kitten relative_resize.py left  3
map alt+l kitten relative_resize.py right 3

# Unset when nvim is focused (pass through to smart-splits)
map --when-focus-on var:IS_NVIM alt+j
map --when-focus-on var:IS_NVIM alt+k
map --when-focus-on var:IS_NVIM alt+h
map --when-focus-on var:IS_NVIM alt+l

# ─────────────────────────────────────────────────────────
# Pane creation (symmetric with Ghostty/Zed)
# ─────────────────────────────────────────────────────────

map ctrl+cmd+h launch --location=vsplit --cwd=current
map ctrl+cmd+j launch --location=hsplit --cwd=current
map ctrl+cmd+k launch --location=hsplit --cwd=current
map ctrl+cmd+l launch --location=vsplit --cwd=current

# ─────────────────────────────────────────────────────────
# Tabs
# ─────────────────────────────────────────────────────────

map cmd+t new_tab_with_cwd

# ─────────────────────────────────────────────────────────
# Pane management
# ─────────────────────────────────────────────────────────

map ctrl+cmd+z toggle_layout stack
map ctrl+cmd+0 resize_window reset
map cmd+w close_window
map --when-focus-on var:IS_NVIM cmd+w